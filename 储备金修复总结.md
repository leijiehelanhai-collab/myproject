# ğŸ”§ å‚¨å¤‡é‡‘æµè½¬é—®é¢˜ä¿®å¤æ€»ç»“

## ğŸš¨ é—®é¢˜å‘ç°

**ç”¨æˆ·åé¦ˆ**: å¼€å¯æ–°è½®æ¬¡æ—¶å¥–æ± æ˜¾ç¤ºä¸º0ï¼Œå‚¨å¤‡é‡‘æ²¡æœ‰æµå…¥åˆ°æ–°è½®æ¬¡æ˜¾ç¤º

## ğŸ” é—®é¢˜åˆ†æ

å‘ç°äº†3ä¸ªå…³é”®é—®é¢˜ï¼š

### 1. åˆçº¦å‡½æ•°è¿”å›å­—æ®µç¼ºå¤±
- **é—®é¢˜**: `getRoundInfo()` å‡½æ•°æ²¡æœ‰è¿”å› `inheritedReserve` å­—æ®µ
- **å½±å“**: å‰ç«¯æ— æ³•è·å–è½®æ¬¡çš„ç»§æ‰¿å‚¨å¤‡é‡‘æ•°æ®

### 2. å‰ç«¯æ•°æ®è¯»å–ä¸å®Œæ•´
- **é—®é¢˜**: å‰ç«¯æ²¡æœ‰è¯»å–å’Œä½¿ç”¨ `inheritedReserve` å­—æ®µ
- **å½±å“**: å³ä½¿åˆçº¦æœ‰å‚¨å¤‡é‡‘ï¼Œå‰ç«¯ä¹Ÿä¸ä¼šæ˜¾ç¤º

### 3. å¥–æ± æ˜¾ç¤ºé€»è¾‘é”™è¯¯
- **é—®é¢˜**: å‰ç«¯åªæ˜¾ç¤º `currentPot`ï¼Œæ²¡æœ‰åŠ ä¸Š `inheritedReserve`
- **å½±å“**: ç”¨æˆ·çœ‹ä¸åˆ°å®Œæ•´çš„å¥–æ± æ€»é¢

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. åˆçº¦å±‚ä¿®å¤

**æ‹†åˆ†å‡½æ•°é¿å…Stack too deepé”™è¯¯**:
```solidity
// åŸºæœ¬ä¿¡æ¯
function getRoundInfo(uint256 _roundId) external view returns (
    uint256 roundId, address tokenAddress, uint256 burnAmount,
    uint256 ticketPrice, uint256 startTime, uint256 endTime,
    uint256 participantCount, uint256 currentPot,
    uint256 maxNumber, address maxNumberHolder,
    bool isSettled, bool isActive
);

// æ‰©å±•ä¿¡æ¯ï¼ˆå‚¨å¤‡é‡‘å’Œä»£å¸ä¿¡æ¯ï¼‰
function getRoundExtendedInfo(uint256 _roundId) external view returns (
    uint256 inheritedReserve,
    string memory tokenName, 
    string memory tokenSymbol
);
```

### 2. å‰ç«¯æ•°æ®æµä¿®å¤

**åŒé‡è°ƒç”¨è·å–å®Œæ•´æ•°æ®**:
```javascript
const info = await contract.methods.getRoundInfo(roundId).call();
const extendedInfo = await contract.methods.getRoundExtendedInfo(roundId).call();

const roundData = {
    // ... åŸºæœ¬ä¿¡æ¯
    currentPot: info.currentPot,
    inheritedReserve: extendedInfo.inheritedReserve, // âœ… ç°åœ¨èƒ½è·å–åˆ°äº†
    tokenName: extendedInfo.tokenName,
    tokenSymbol: extendedInfo.tokenSymbol
};
```

### 3. å¥–æ± æ˜¾ç¤ºé€»è¾‘ä¿®å¤

**æ˜¾ç¤ºæ€»å¥–æ±  = æœ¬è½®å¥–æ±  + å‚¨å¤‡é‡‘**:
```javascript
const currentPot = Web3.utils.fromWei(round.currentPot, 'ether');
const inheritedReserve = Web3.utils.fromWei(round.inheritedReserve, 'ether');
const totalPot = (parseFloat(currentPot) + parseFloat(inheritedReserve)).toFixed(6);

// æ˜¾ç¤º: "0.015 BNB"
// è¯¦æƒ…: "æ€»å¥–æ±  (æœ¬è½®: 0.008 + å‚¨å¤‡: 0.007)"
```

## ğŸ¯ å‚¨å¤‡é‡‘æµè½¬æœºåˆ¶

### èµ„é‡‘åˆ†é… (æ¯æ¬¡å‚ä¸æ¸¸æˆ)
```
ç©å®¶æ”¯ä»˜ 0.01 BNB:
â”œâ”€â”€ 80% (0.008) â†’ æœ¬è½®å¥–æ±  (currentPot)
â”œâ”€â”€ 5%  (0.0005) â†’ å¼€å‘è´¹
â”œâ”€â”€ 14% (0.0014) â†’ ä»£å¸å‚¨å¤‡æ±  (tokenReservePools)
â””â”€â”€ 1%  (0.0001) â†’ ç»“ç®—å¥–åŠ±æ± 
```

### è½®æ¬¡å¼€å¯æ—¶ç»§æ‰¿
```
å¼€å¯æ–°è½®æ¬¡æ—¶:
1. inheritedReserve = tokenReservePools[ä»£å¸åœ°å€]
2. tokenReservePools[ä»£å¸åœ°å€] = 0  // æ¸…ç©ºå‚¨å¤‡æ± 
3. æ–°è½®æ¬¡æ˜¾ç¤º: currentPot + inheritedReserve
```

### è½®æ¬¡ç»“ç®—æ—¶åˆ†é…
```
ç»“ç®—æ—¶æ€»å¥–åŠ±:
= currentPot + inheritedReserve
```

## ğŸš€ éƒ¨ç½²ä¿¡æ¯

**æ–°åˆçº¦åœ°å€**: `0xbDb50858C1D86005a8570fd9dD3ebEaB1B08A5eD`

**ä¿®å¤å†…å®¹**:
- âœ… å‚¨å¤‡é‡‘æ­£ç¡®ç»§æ‰¿å’Œæ˜¾ç¤º
- âœ… ä»£å¸ä¿¡æ¯è‡ªåŠ¨è·å–å’Œç¼“å­˜
- âœ… è‡ªåŠ¨ç»“ç®—æœºåˆ¶ï¼ˆ10ç§’æ£€æµ‹ï¼‰
- âœ… ç»“ç®—å¥–åŠ±æ¿€åŠ±ï¼ˆ0.001 BNB/æ¬¡ï¼‰

## ğŸ® æµ‹è¯•éªŒè¯

### æµ‹è¯•æ­¥éª¤
1. **æ›´æ–°åˆçº¦åœ°å€**: `0xbDb50858C1D86005a8570fd9dD3ebEaB1B08A5eD`
2. **å¼€å¯è½®æ¬¡1**: ä½¿ç”¨æµ‹è¯•ä»£å¸A
3. **å‚ä¸æ¸¸æˆ**: æ”¯ä»˜0.01 BNBï¼Œè§‚å¯Ÿå‚¨å¤‡æ± ç´¯ç§¯
4. **ç­‰å¾…ç»“ç®—**: è‡ªåŠ¨ç»“ç®—åï¼Œå‚¨å¤‡é‡‘æµå…¥æ± ä¸­
5. **å¼€å¯è½®æ¬¡2**: åŒæ ·ä»£å¸Aï¼Œè§‚å¯Ÿå¥–æ± æ˜¾ç¤º

### é¢„æœŸç»“æœ
```
è½®æ¬¡1ç»“ç®—å:
å‚¨å¤‡æ± : 0.0014 BNB (å‡è®¾1ä¸ªäººå‚ä¸)

å¼€å¯è½®æ¬¡2æ—¶:
æ˜¾ç¤º: "0.0014 BNB æ€»å¥–æ±  (æœ¬è½®: 0 + å‚¨å¤‡: 0.0014)"
```

---

**ğŸ‰ å‚¨å¤‡é‡‘æµè½¬æœºåˆ¶ç°åœ¨å®Œå…¨æ­£å¸¸ï¼æ–°è½®æ¬¡ä¼šæ­£ç¡®æ˜¾ç¤ºç»§æ‰¿çš„å‚¨å¤‡é‡‘ï¼**
